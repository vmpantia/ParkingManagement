<!-- Customer Information Modal -->
<div class="modal fade modal-xl" id="customerModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="customerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="customerModalLabel"> 
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-bounding-box" viewBox="0 0 16 16">
                <path d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z"/>
                <path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm8-9a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
            </svg>
            {{ modalTitle }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"
                  (click)="closeCustomerForm()"></button>
        </div>
        <div class="modal-body">
            <div class="container" *ngIf="customerInfo">
                <!-- Notes -->
                <div class="row">
                    <div class="col-12 alert alert-warning" role="alert">
                        Field with <b>Asterisk(*)</b>  are Required.
                    </div>
                </div>

                <!-- Error Messages -->
                <div class="row">
                    <div class="alert alert-danger" role="alert" *ngIf="errorMessages?.length !== 0">
                       <span *ngFor="let error of errorMessages">{{error}}<br></span>
                    </div>
                </div>

                <!-- Personal Information -->
                <div class="row mb-3">
                    <div class="cstm-info">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-person-fill" viewBox="0 0 16 16">
                            <path d="M12 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zm-1 7a3 3 0 1 1-6 0 3 3 0 0 1 6 0zm-3 4c2.623 0 4.146.826 5 1.755V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-1.245C3.854 11.825 5.377 11 8 11z"/>
                        </svg>
                        <span> PERSONAL INFORMATION </span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-12 col-lg-4">
                        <div class="mb-3">
                            <label class="form-label">* First Name:</label>
                            <input type="text" class="form-control" [(ngModel)]="customerInfo.firstName" name="firstName" placeholder="Input First Name" maxlength="40">
                        </div>
                    </div>
                    <div class="col-12 col-lg-4">
                        <div class="mb-3">
                            <label class="form-label">* Last Name:</label>
                            <input type="text" class="form-control" [(ngModel)]="customerInfo.lastName" name="lastName" placeholder="Input Last Name" maxlength="40">
                        </div>
                    </div>
                    <div class="col-12 col-lg-4">
                        <div class="mb-3">
                            <label class="form-label">Middle Name:</label>
                            <input type="text" class="form-control" [(ngModel)]="customerInfo.middleName" name="middleName" placeholder="Input Middle Name" maxlength="40">
                        </div>
                    </div>
                </div>
                
                <!-- Contact Information -->
                <div class="row mb-3">
                    <div class="cstm-info">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-geo-fill" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z"/>
                        </svg>
                        <span> CONTACT INFORMATION </span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-12 col-lg-4">
                        <div class="mb-3">
                            <label class="form-label">* Contact No.:</label>
                            <input type="text" class="form-control" [(ngModel)]="customerInfo.contactNo" name="contactNo" placeholder="Input Contact Number" maxlength="15">
                        </div>
                    </div>
                    <div class="col-12 col-lg-8">
                        <div class="mb-3">
                            <label class="form-label">* Address:</label>
                            <input type="text" class="form-control" [(ngModel)]="customerInfo.address" name="address" placeholder="Input Address" maxlength="100">
                        </div>
                    </div>
                </div>
            
                <!-- Cars Information -->
                <div class="row mb-3">
                    <div class="cstm-info">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-car-front-fill" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M2.52 3.515A2.5 2.5 0 0 1 4.82 2h6.362c1 0 1.904.596 2.298 1.515l.792 1.848c.075.175.21.319.38.404.5.25.855.715.965 1.262l.335 1.679c.033.161.049.325.049.49v.413c0 .814-.39 1.543-1 1.997V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.338c-1.292.048-2.745.088-4 .088s-2.708-.04-4-.088V13.5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1-.5-.5v-1.892c-.61-.454-1-1.183-1-1.997v-.413a2.5 2.5 0 0 1 .049-.49l.335-1.68c.11-.546.465-1.012.964-1.261a.807.807 0 0 0 .381-.404l.792-1.848ZM3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm10 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6 8a1 1 0 0 0 0 2h4a1 1 0 1 0 0-2H6ZM2.906 5.189l.956-1.913A.5.5 0 0 1 4.309 3h7.382a.5.5 0 0 1 .447.276l.956 1.913a.51.51 0 0 1-.497.731c-.91-.073-3.35-.17-4.597-.17-1.247 0-3.688.097-4.597.17a.51.51 0 0 1-.497-.731Z"/>
                        </svg>
                        <span> CARS </span>
                    </div>
                </div>

                <!-- Car Sub Form -->
                <div class="row" *ngIf="isCarSubFormShow">

                    <div class="col-12 col-lg-4">
                        <div class="mb-3">
                            <label class="form-label">* Plate No:</label>
                            <input type="text" class="form-control" [(ngModel)]="carInfo.plateNo" name="plateNo" placeholder="Input Plate Number" maxlength="20">
                        </div>
                    </div>
                    <div class="col-12 col-lg-2">
                        <div class="mb-3">
                            <label class="form-label">* Type:</label>
                            <input type="text" class="form-control" [(ngModel)]="carInfo.type" name="type" placeholder="Input Type" maxlength="20">
                        </div>
                    </div>
                    <div class="col-12 col-lg-2">
                        <div class="mb-3">
                            <label class="form-label">* Year Model:</label>
                            <input type="text" class="form-control" [(ngModel)]="carInfo.yearModel" name="yearModel" placeholder="Input Year Model" maxlength="4">
                        </div>
                    </div>
                    <div class="col-12 col-lg-2">
                        <div class="mb-3">
                            <label class="form-label">* Make:</label>
                            <input type="text" class="form-control" [(ngModel)]="carInfo.make" name="make" placeholder="Input Make" maxlength="20">
                        </div>
                    </div>
                    <div class="col-12 col-lg-2">
                        <div class="mb-3">
                            <label class="form-label">* Color:</label>
                            <input type="text" class="form-control" [(ngModel)]="carInfo.color" name="color" placeholder="Input Color" maxlength="20">
                        </div>
                    </div>    
                    <div class="row mb-3">
                        <div class="col-12">
                            <button type="button" class="btn btn-success btn-sm"
                                (click)="saveCarFromSubForm()">
                                Save
                            </button>
                            &nbsp;
                            <button type="button" class="btn btn-secondary btn-sm"
                                (click)="closeCarSubForm()">
                                Cancel
                            </button>
                        </div>
                    </div>

                </div>

                <!-- Car List -->
                <div class="row" *ngIf="!isCarSubFormShow">
                    <div class="row mb-3">
                        <div class="col-12">
                            <button type="button" class="btn btn-primary btn-sm"
                                (click)="addCarFromSubForm()">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
                                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                                </svg>
                                Add Car
                            </button>
                        </div>
                    </div>
                    <div class="col-12">
                        <table class="table table-striped table-hover table-bordered">
                            <thead>
                                <tr>
                                    <td>Plate No.</td>
                                    <td>Type</td>
                                    <td>Year Model</td>
                                    <td>Make</td>
                                    <td>Color</td>
                                    <td>Status</td>
                                    <td>Created Date</td>
                                    <td>Action</td>
                                </tr>
                            </thead>
                    
                            <tbody>
                            <tr *ngIf="customerInfo.cars?.length === 0">
                                <td class="text-center" colspan="8">
                                    No cars found in this customer
                                </td>
                            </tr>
                            <tr *ngFor="let car of customerInfo.cars">
                                <td>{{ car.plateNo }}</td>
                                <td>{{ car.type }}</td>
                                <td>{{ car.yearModel }}</td>
                                <td>{{ car.make }}</td>
                                <td>{{ car.color }}</td>

                                <!-- Status Condition -->
                                <ng-container *ngIf="car.status == 0;">
                                    <td class="text-center"><span class="badge bg-success">Enabled</span></td>
                                </ng-container>
                                <ng-container *ngIf="car.status == 1;">
                                    <td class="text-center"><span class="badge bg-secondary">Disabled</span></td>
                                </ng-container>
                                <ng-container *ngIf="car.status == 2;">
                                    <td class="text-center"><span class="badge bg-danger">Deletion</span></td>
                                </ng-container>

                                <td class="text-center">{{ car.createdDate| date: "MM-dd-YYYY" }}</td>
                                
                                <!-- Action Buttons -->
                                <td class="text-center">
                                <button type="button" class="btn btn-warning btn-sm">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                        <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                        <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                    </svg>
                                    Edit
                                </button> &nbsp;
                                <button type="button" class="btn btn-danger btn-sm"> 
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                        <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
                                    </svg>
                                    Delete
                                </button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            
                <!-- Save Button -->
                <div class="row" *ngIf="!isCarSubFormShow">
                    <button type="button" class="btn btn-success btn-sm"
                        (click)="saveCustomer()">
                        Save Customer
                    </button>
                </div>
            </div>
        </div>
      </div>
    </div>
  </div>

<!-- Customers List -->
<div class="container">  

    <!-- Page Title -->
    <div class="row mb-3">
        <div class="col-12 cstm-page-header">
            <div class="page-name">
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-people-fill" viewBox="0 0 16 16">
                <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                <path fill-rule="evenodd" d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216z"/>
                <path d="M4.5 8a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"/>
            </svg>
            Customers
            </div>
            <div class="page-description">
            <span>This page will provide you a list of customers stored in the system.</span>
            </div>
        </div>
    </div>

    <!-- Add New -->
    <div class="row mb-3">
        <div class="col-8">
            <!-- Button trigger modal -->
            <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#customerModal"
                    (click)="addCustomer()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-person-plus-fill" viewBox="0 0 16 16">
                    <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                    <path fill-rule="evenodd" d="M13.5 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H14v1.5a.5.5 0 0 1-1 0V8h-1.5a.5.5 0 0 1 0-1H13V5.5a.5.5 0 0 1 .5-.5z"/>
                </svg>
                Add
            </button>
        </div>
    </div>
        
    <!-- Table -->
    <div class="row">
        <div class="col-12">
            <table class="table table-striped table-hover table-bordered">
                <thead>
                    <tr>
                        <td>Name</td>
                        <td>Contact No.</td>
                        <td>Address</td>
                        <td>Status</td>
                        <td>Created Date</td>
                        <td>Modified Date</td>
                        <td>Action</td>
                    </tr>
                </thead>

                <tbody>
                    <tr *ngIf="errorMessages.length !== 0">
                        <td class="text-center" colspan="7">
                            Error in getting data from database
                        </td>   
                    </tr>
                    <tr *ngIf="customers?.length === 0">
                        <td class="text-center" colspan="7">
                            No data found in database
                        </td>
                    </tr>
                    <tr *ngFor="let customer of customers">
                        <td>{{ customer.lastName }}, {{ customer.firstName }} {{ customer.middleName }}</td>
                        <td>{{ customer.contactNo }}</td>
                        <td>{{ customer.address }}</td> 

                        <!-- Status Condition -->
                        <ng-container *ngIf="customer.status == 0;">
                            <td class="text-center"><span class="badge bg-success">Enabled</span></td>
                        </ng-container>
                        <ng-container *ngIf="customer.status == 1;">
                            <td class="text-center"><span class="badge bg-secondary">Disabled</span></td>
                        </ng-container>
                        <ng-container *ngIf="customer.status == 2;">
                            <td class="text-center"><span class="badge bg-danger">Deletion</span></td>
                        </ng-container>

                        <td class="text-center">{{ customer.createdDate| date: "MM-dd-YYYY" }}</td>
                        <td class="text-center">{{ customer.modifiedDate | date: "MM-dd-YYYY" }}</td>

                        <!-- Action Buttons -->
                        <td class="text-center">
                            <button type="button" class="btn btn-warning btn-sm"
                                    data-bs-toggle="modal" data-bs-target="#customerModal" 
                                    (click)="editCustomer(customer.customerId)">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"/>
                                </svg>
                                Edit
                            </button> &nbsp;
                            <button type="button" class="btn btn-danger btn-sm"> 
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16">
                                <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
                                </svg>
                                Delete
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>